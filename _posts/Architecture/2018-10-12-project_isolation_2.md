---

layout: post
title: 项目隔离2——工程设计
category: 架构
tags: Architecture
keywords: 项目隔离 多版本

---

## 简介（未完成）

项目隔离涉及到哪些基本问题？

## 本文约定的术语

1. 多版本

## 测试环境不稳定 具体说的是什么？


表现：

1. app 调用后端 无响应
2. rpcA 调用rpcB 无响应

具体原因：

1. 重启带来的中断
2. 开发代码本身有问题
	
	1. 能启动，但业务逻辑有问题
	2. 启动不起来

	
## 几个取舍

1. 到底是只支持一个开发/稳定 版， 还是不对“隔离组”的概念设上限

	* 只支持开发版/稳定版
	* 支持任意隔离组，v0视为稳定版，其它版本均视为开发版

2. 一个项目有多少个版本，多版本状态持续多长时间

	* 一个项目至少两个版本，开发和稳定
	* 项目稳定后，移除开发状态版本

3. 开发版本的流量如何保证，流量有几个入口

	* 最源头的app
	* 开发机测试
	* 上游的同样处于开发版本的服务

## app 调用后端 无响应

那么现在的需求是什么？

1. 我就是测你那个开发功能
2. 我不测你那个功能，测试别的，你把环境给我搞稳定

解决办法：

1. 通过域名分隔，比如`mobile.test.xx.com` `mobile.dev.xx.com`
2. 通过cookie tag 

测试开发版功能时，切换至`mobile.dev.xx.com`，稳定版功能切换至`mobile.test.xx.com`

从app 侧来说，为了降低复杂性，应用的版本数量不适合过多，最好只有开发和稳定两个。


## rpcA 调用rpcB 无响应




	
开发机器调用开发版本






